<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="css/test-ajax1.css">
</head>
<body>
	<button id="btn">按钮</button>
</body>
<script>
	var oBtn = document.getElementById('btn');

	oBtn.onclick = function(){
		//XMLHttpRequest

		//1.购买电话
		var xhr = new XMLHttpRequest()

		//2.拨号
		xhr.open('GET','http://127.0.0.1:3000/getData?name=tom&age=18&city=beijing',true)//true代表异步，反之不是异步

		xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded')

		//3.说话(发送请求)
		xhr.send()

		//4.听(介绍响应)
		xhr.onreadystatechange = function(){
			if(xhr.readyState == 4){
				 if(xhr.status == 200){
				 	try{
				 		var obj = JSON.parse(xhr.responseText)
				 	}catch(e){
				 		console.log(e)//捕获防止服务器返回的数据不是json而解析出错
				 	}

				 }else{
				 	console.log(xhr.status)
				 		console.log('failed request,state code = '+xhr.status)
				 }
			}
		}

		console.log('do something')
	}

</script>
</html>